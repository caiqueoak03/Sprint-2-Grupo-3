<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Soy Venture</title>
		<link rel="stylesheet" href="../../styles/headerDashboard.css" />
		<link rel="stylesheet" href="../../styles/confirmationBox.css" />
		<link rel="stylesheet" href="../../styles/cadastroFazenda.css" />
		<link
			rel="shortcut icon"
			href="../../images/logo.png"
			type="image/x-icon"
		/>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400&family=Roboto:ital,wght@0,400;0,700;1,700&display=swap"
			rel="stylesheet"
		/>
		<script
			src="https://kit.fontawesome.com/8c4cdd8d42.js"
			crossorigin="anonymous"
		></script>
	</head>
	<body onload="iniciarSessao()">
		<!-- HEADER -->
		<header>
			<span class="logo">
				<img src="../../images/logo.png" alt="" class="logo-img" />
				<h1 class="nome-empresa">Soy Venture</h1>
			</span>

			<div class="usuario-container">
				<img src="../../images/gerente-img.png" alt="" class="img" />
				<p class="usuario-nome">Olá, <b id="nome_usuario"></b></p>
			</div>

			<div class="main-nav">
				<ul>
					<a class="navs nav1" href="dashboard.html">Gráficos</a>
					<a class="navs nav2" href="KPIs.html">Indicadores de Performance</a>
					<a
						class="navs nav3"
						id="cad_funcionario"
						href="cadastro_funcionario.html"
						>Cadastrar Funcionário</a
					>
					<a class="navs nav4" id="cad_fazenda" href="cadastroFazenda.html"
						>Cadastrar Fazenda</a
					>
					<a class="navs nav5" href="alterarDados.html">Alterar Dados</a>
					<a class="navs nav7" onclick="mostrarBox()">Sair</a>
				</ul>
			</div>
		</header>

		<!-- Confirmation Box -->
		<div id="confirmation_wrapper">
			<div class="confirmation-box">
				<p>Deseja sair da sua conta?</p>
				<div class="sim-ou-nao">
					<a onclick="limparSessao()">sim</a>
					<a onclick="esconderBox()">não</a>
				</div>
			</div>
		</div>

		<!-- MONITORAMENTO POR HORA -->
		<div class="main-container">
			<div class="cadastro">
				<div class="container">
					<div class="box">
						<div class="box_container">
							<div class="card_cadastro2">
								<ul>
									<h2>Cadastro da Fazenda</h2>

									<li>
										Nome da Fazenda<br /><input
											placeholder="Nome da Fazenda"
											id="in_nomeFazenda"
											type="text"
										/>
									</li>
									<li>
										Numero de Telefone Fixo: <br /><input
											placeholder="(00) 00000-0000"
											id="in_telFixo"
											type="text"
										/>
									</li>
									<li>
										Numero de Telefone Celular: <br /><input
											placeholder="(00) 00000-0000"
											id="in_telCelular"
											type="text"
										/>
									</li>
								</ul>

								<div class="li_card">
									<ul>
										<li>
											CEP <br /><input
												placeholder="CEP(000-00-000)"
												id="in_cep"
												type="text"
											/>
										</li>

										<li>
											Área em Hectare <br /><input
												placeholder="Hectares"
												type="text"
											/>
										</li>

										<li><button>Cadastrar Fazenda</button></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
<script>
	function esconderBox() {
		confirmation_wrapper.style.display = "none";
	}

	function mostrarBox() {
		confirmation_wrapper.style.display = "flex";
	}

	function validar() {
		var nomeFazenda = in_nomeFazenda.value;
		var telFixo = in_telFixo.value;
		var telcelular = in_telcelular.value;
		var cep = in_cep.value;
		var alerta = "";

		if (nomeFazenda == "") {
			alerta += "\n*Insira o nome da fazenda";
		}

		if (telefone_fixo == "") {
			alerta += "\n*Digite um telefone fixo";
		} else if (telefone_fixo.length != 10) {
			alerta += "\n*Telefone Fixo incorreto, insira novamente!!";
		}

		if (telefone_celular == "") {
			alerta += "\n*Digite um telefone celular";
		} else if (telefone_celular.length != 11) {
			alerta += "\n*Telefone Celular incorreto, insira novamente!!";
		}

		if (alerta != "") {
			alert(alerta.trim());
		} else {
			cadastrarFazenda();
		}
	}
	function cadastrarFazenda() {
		//Recupere o valor da nova input pelo nome do id
		// Agora vá para o método fetch logo abaixo
		var nomeFazendaVar = in_nomeFazenda.value;
		var telFixoVar = in_telFixo.value;
		var telcelularVar = in_telcelular.value;
		var cepVar = in_cep.value;

		// Enviando o valor da nova input
		fetch("/usuarios/cadastrarFazenda", {
			method: "POST",
			headers: {
				"Content-Type": "application/json",
			},
			body: JSON.stringify({
				// crie um atributo que recebe o valor recuperado aqui
				// Agora vá para o arquivo routes/usuario.js
				nomeFazendaServer: nomeFazendaVar,
				telFixoServer: telFixoVar,
				telCelularServer: telCelularVar,
				cepServer: cepVar,
			}),
		})
			.then(function (resposta) {
				console.log("resposta: ", resposta);

				if (resposta.ok) {
					in_nomeFazenda.value = "";
					in_telFixo.value = "";
					in_telcelular.value = "";
					in_cep.value = "";
				} else {
					alert("Fazenda já cadastrada!");
				}
			})
			.catch(function (resposta) {
				console.log(`#ERRO: ${resposta}`);
			});

		return false;
	}
</script>
<script src="../../js/funcoes.js"></script>
